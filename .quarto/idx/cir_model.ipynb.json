{"title":"**The CIR Stochastic Differential Equation (SDE)**","markdown":{"yaml":{"title":"**The CIR Stochastic Differential Equation (SDE)**"},"headingText":"**Key Properties of the CIR Model**","containsRefs":false,"markdown":"\n\n\n\n$$dr_t = a(b-r_t)dt + \\sigma \\sqrt{r_t}dW_t$$\nWhere:\n- $ r_t $ is the interest rate at time \\( t \\)\n- $ a $ is the speed of mean reversion\n- $ b $ is the long-term mean level of the interest rate\n- $ \\sigma $ is the volatility of the interest rate\n- $ W_t $ is a standard Wiener process (Brownian motion)\n1. **Mean Reversion**: The term $ a(b - r_t) $ ensures that the interest rate tends to revert to the long-term mean $ b $ over time.\n2. **Non-Negativity**: The square root term $ \\sqrt{r_t} $ ensures that the interest rate remains non-negative, provided that the Feller condition $ 2ab \\geq \\sigma^2 $ is satisfied.\n3. **Volatility Structure**: The volatility of the interest rate is proportional to the square root of the current rate, meaning that volatility decreases as the interest rate approaches zero.\n### **Applications of the CIR Model**\n- **Interest Rate Modeling**: The CIR model is widely used to model the evolution of interest rates over time in financial markets.\n- **Bond Pricing**: It is used to price interest rate derivatives and bonds, particularly those with embedded options.\n- **Risk Management**: The model helps in assessing the risk associated with interest rate movements for financial institutions.\n### **Solution to the CIR SDE**\nThe CIR model has a known closed-form solution for the transition density of $ r_t $. The distribution of $ r_t $ given $ r_0 $ is a non-central chi-squared distribution. Specifically, if $ r_0 $ is the initial interest rate, then:\n$$ r_t \\sim \\frac{\\sigma^2(1 - e^{-at})}{4a} \\chi^2_{d}(\\lambda) $$\nWhere:\n- $ d = \\frac{4ab}{\\sigma^2} $ is the degrees of freedom\n- $ \\lambda = \\frac{4a e^{-at} r_0}{\\sigma^2(1 - e^{-at})} $ is the non-centrality parameter\n### **Parameter Estimation**\nParameters $ a $, $ b $, and $ \\sigma $ can be estimated using historical interest rate data through methods such as Maximum Likelihood Estimation (MLE) or the Generalized Method of Moments (GMM).\n### **Numerical Simulation of the CIR Model**\nTo simulate paths of the CIR model, one can use the Euler-Maruyama method or more advanced techniques like the Milstein scheme. A simple Euler discretization is given by:\n$$ r_{t+\\Delta t} = r_t + a(b - r_t)\\Delta t + \\sigma \\sqrt{r_t} \\sqrt{\\Delta t} Z $$\nWhere $ Z $ is a standard normal random variable.\n\n\n\n### **Task 2: Simulation and Monte Carlo Pricing**\n\n\n- **Discretize the SDE using the Euler-Maruyama method.**\n\n    - Interval $[0,T]$ : step size $\\Delta t = \\frac{T}{N}$, where $N$ is the number of time steps.\n\n    For the **CIR model**, the discretized form is:\n    $$ r_{t+\\Delta t} = r_t + a(b - r_t)\\Delta t + \\sigma \\sqrt{r_t} \\sqrt{\\Delta t} Z $$\n    Where $ Z \\sim N(0,1) $ is a standard normal random variable.\n\n- **Calculate the bond price at maturity $T$ using the simulated interest rate paths.**\n\n    The price of a zero-coupon bond at time $t$ maturing at time $T$ is given by:\n    $$ P(t,T) = E_t\\left[e^{-\\int_t^T r_s ds}\\right] $$\n\n    Using Monte Carlo simulation, we can approximate this expectation by averaging over multiple simulated paths of the interest rate.\n    \n- **Estimate the bond price using Monte Carlo simulation.**\n    1. Simulate multiple paths of the interest rate $r_t$ using the discretized CIR model.\n    2. For each path, compute the integral $\\int_0^T r_s ds$ using numerical integration (e.g., trapezoidal rule).\n    3. Calculate the bond price for each path and average the results to get the estimated bond price:\n    $$ \\hat{P}(0,T) = \\frac{1}{M} \\sum_{i=1}^{M} e^{-\\int_0^T r_s^{(i)} ds} $$\n    Where $M$ is the number of simulated paths and $r_s^{(i)}$ is the interest rate path for the $i$-th simulation.\n    \n\n- **Calculate the Bond Price**\n    - For each simulated path $i$, calculate the \"Stochastic Discount Factor\" (SDF):\n    $$ D_i = \\exp \\left(-\\sum_{j=1}^{M} r_j \\Delta t \\right) $$\n\n    - The Monte Carlo price is the average of these factors across all $N$ paths:\n\n    $$ P_{MC}(0,T) \\approx \\frac{1}{N} \\sum_{i=1}^{N} D_i $$\n\n\n### **Task 3: Analytical Bond Pricing**\n\n\n- The analytical bond price in the CIR model is given by:\n$$ P(0,T) = A(T) e^{-B(T) r_0} $$\nWhere:\n- We define a constant  $\\gamma = \\sqrt{a^2 + 2\\sigma^2}$\n- $$ A(T) = \\left( \\dfrac{2\\gamma e^{(a+\\gamma)T/2}}{(a+\\gamma)(e^{\\gamma T}-1) + 2\\gamma} \\right)^{\\frac{2ab}{\\sigma^2}} $$\n- $$ B(T) = \\dfrac{2(e^{\\gamma T}-1)}{(a+\\gamma)(e^{\\gamma T}-1) + 2\\gamma} $$\n\n**Comparison of Monte Carlo and Analytical Prices**\n\nThis plot compares the Zero-Coupon Bond prices calculated using the exact mathematical formula (Analytical) against the average of $500$ simulated paths (Monte Carlo).\n\n- **Observations:** The Monte Carlo prices (marked with 'x') align almost perfectly with the analytical prices (the solid line). This confirms that your simulation logic is correct.\n\n- **Trend:** As maturity increases, the bond price decreases. This is intuitive, as a dollar received 10 years from now is worth less today than a dollar received 1 year from now.\n\n### **Task 4: Yield Curve and Parameter Analysis**\n\n- **Yield Curve Generation**\n    - Using the analytical bond pricing formula, generate the yield curve for different maturities $ T $ by calculating the yield $ y(0,T) $:\n    $$ y(0,T) = -\\frac{1}{T} \\ln(P(0,T)) $$\n\n- **Parameter Sensitivity Analysis**\n    - Analyze how changes in parameters $ a $, $ b $, and $ \\sigma $ affect the shape of the yield curve.\n    - For example, increase/decrease each parameter by a certain percentage and observe the resulting changes in bond prices and yields.\n\nThis dashboard shows how the term structure of interest rates changes when you manipulate the model's \"knobs\" ($a, b, \\sigma$).\n\n1. **Base Case:** A typical upward-sloping yield curve starting at $r_0 = 0.03$ and converging toward the mean.\n\n2. **Sensitivity to $a$ (Speed):** A higher $a$ (0.8 vs 0.2) causes the curve to reach the long-term mean much faster, resulting in a steeper initial slope.\n\n3. **Sensitivity to $b$ (Mean):** Increasing $b$ shifts the entire \"long end\" of the curve upward, as the market expects rates to be higher in the distant future.\n\n4. **Sensitivity to $\\sigma$ (Volatility):** Higher volatility actually creates a downward pressure on the yield curve for long maturities. This is due to \"convexity bias\"—as uncertainty increases, the value of the bond's floor (it can't go below zero) becomes more valuable, raising the bond price and thus lowering the yield.\n","srcMarkdownNoYaml":"\n\n\n\n$$dr_t = a(b-r_t)dt + \\sigma \\sqrt{r_t}dW_t$$\nWhere:\n- $ r_t $ is the interest rate at time \\( t \\)\n- $ a $ is the speed of mean reversion\n- $ b $ is the long-term mean level of the interest rate\n- $ \\sigma $ is the volatility of the interest rate\n- $ W_t $ is a standard Wiener process (Brownian motion)\n### **Key Properties of the CIR Model**\n1. **Mean Reversion**: The term $ a(b - r_t) $ ensures that the interest rate tends to revert to the long-term mean $ b $ over time.\n2. **Non-Negativity**: The square root term $ \\sqrt{r_t} $ ensures that the interest rate remains non-negative, provided that the Feller condition $ 2ab \\geq \\sigma^2 $ is satisfied.\n3. **Volatility Structure**: The volatility of the interest rate is proportional to the square root of the current rate, meaning that volatility decreases as the interest rate approaches zero.\n### **Applications of the CIR Model**\n- **Interest Rate Modeling**: The CIR model is widely used to model the evolution of interest rates over time in financial markets.\n- **Bond Pricing**: It is used to price interest rate derivatives and bonds, particularly those with embedded options.\n- **Risk Management**: The model helps in assessing the risk associated with interest rate movements for financial institutions.\n### **Solution to the CIR SDE**\nThe CIR model has a known closed-form solution for the transition density of $ r_t $. The distribution of $ r_t $ given $ r_0 $ is a non-central chi-squared distribution. Specifically, if $ r_0 $ is the initial interest rate, then:\n$$ r_t \\sim \\frac{\\sigma^2(1 - e^{-at})}{4a} \\chi^2_{d}(\\lambda) $$\nWhere:\n- $ d = \\frac{4ab}{\\sigma^2} $ is the degrees of freedom\n- $ \\lambda = \\frac{4a e^{-at} r_0}{\\sigma^2(1 - e^{-at})} $ is the non-centrality parameter\n### **Parameter Estimation**\nParameters $ a $, $ b $, and $ \\sigma $ can be estimated using historical interest rate data through methods such as Maximum Likelihood Estimation (MLE) or the Generalized Method of Moments (GMM).\n### **Numerical Simulation of the CIR Model**\nTo simulate paths of the CIR model, one can use the Euler-Maruyama method or more advanced techniques like the Milstein scheme. A simple Euler discretization is given by:\n$$ r_{t+\\Delta t} = r_t + a(b - r_t)\\Delta t + \\sigma \\sqrt{r_t} \\sqrt{\\Delta t} Z $$\nWhere $ Z $ is a standard normal random variable.\n\n\n\n### **Task 2: Simulation and Monte Carlo Pricing**\n\n\n- **Discretize the SDE using the Euler-Maruyama method.**\n\n    - Interval $[0,T]$ : step size $\\Delta t = \\frac{T}{N}$, where $N$ is the number of time steps.\n\n    For the **CIR model**, the discretized form is:\n    $$ r_{t+\\Delta t} = r_t + a(b - r_t)\\Delta t + \\sigma \\sqrt{r_t} \\sqrt{\\Delta t} Z $$\n    Where $ Z \\sim N(0,1) $ is a standard normal random variable.\n\n- **Calculate the bond price at maturity $T$ using the simulated interest rate paths.**\n\n    The price of a zero-coupon bond at time $t$ maturing at time $T$ is given by:\n    $$ P(t,T) = E_t\\left[e^{-\\int_t^T r_s ds}\\right] $$\n\n    Using Monte Carlo simulation, we can approximate this expectation by averaging over multiple simulated paths of the interest rate.\n    \n- **Estimate the bond price using Monte Carlo simulation.**\n    1. Simulate multiple paths of the interest rate $r_t$ using the discretized CIR model.\n    2. For each path, compute the integral $\\int_0^T r_s ds$ using numerical integration (e.g., trapezoidal rule).\n    3. Calculate the bond price for each path and average the results to get the estimated bond price:\n    $$ \\hat{P}(0,T) = \\frac{1}{M} \\sum_{i=1}^{M} e^{-\\int_0^T r_s^{(i)} ds} $$\n    Where $M$ is the number of simulated paths and $r_s^{(i)}$ is the interest rate path for the $i$-th simulation.\n    \n\n- **Calculate the Bond Price**\n    - For each simulated path $i$, calculate the \"Stochastic Discount Factor\" (SDF):\n    $$ D_i = \\exp \\left(-\\sum_{j=1}^{M} r_j \\Delta t \\right) $$\n\n    - The Monte Carlo price is the average of these factors across all $N$ paths:\n\n    $$ P_{MC}(0,T) \\approx \\frac{1}{N} \\sum_{i=1}^{N} D_i $$\n\n\n### **Task 3: Analytical Bond Pricing**\n\n\n- The analytical bond price in the CIR model is given by:\n$$ P(0,T) = A(T) e^{-B(T) r_0} $$\nWhere:\n- We define a constant  $\\gamma = \\sqrt{a^2 + 2\\sigma^2}$\n- $$ A(T) = \\left( \\dfrac{2\\gamma e^{(a+\\gamma)T/2}}{(a+\\gamma)(e^{\\gamma T}-1) + 2\\gamma} \\right)^{\\frac{2ab}{\\sigma^2}} $$\n- $$ B(T) = \\dfrac{2(e^{\\gamma T}-1)}{(a+\\gamma)(e^{\\gamma T}-1) + 2\\gamma} $$\n\n**Comparison of Monte Carlo and Analytical Prices**\n\nThis plot compares the Zero-Coupon Bond prices calculated using the exact mathematical formula (Analytical) against the average of $500$ simulated paths (Monte Carlo).\n\n- **Observations:** The Monte Carlo prices (marked with 'x') align almost perfectly with the analytical prices (the solid line). This confirms that your simulation logic is correct.\n\n- **Trend:** As maturity increases, the bond price decreases. This is intuitive, as a dollar received 10 years from now is worth less today than a dollar received 1 year from now.\n\n### **Task 4: Yield Curve and Parameter Analysis**\n\n- **Yield Curve Generation**\n    - Using the analytical bond pricing formula, generate the yield curve for different maturities $ T $ by calculating the yield $ y(0,T) $:\n    $$ y(0,T) = -\\frac{1}{T} \\ln(P(0,T)) $$\n\n- **Parameter Sensitivity Analysis**\n    - Analyze how changes in parameters $ a $, $ b $, and $ \\sigma $ affect the shape of the yield curve.\n    - For example, increase/decrease each parameter by a certain percentage and observe the resulting changes in bond prices and yields.\n\nThis dashboard shows how the term structure of interest rates changes when you manipulate the model's \"knobs\" ($a, b, \\sigma$).\n\n1. **Base Case:** A typical upward-sloping yield curve starting at $r_0 = 0.03$ and converging toward the mean.\n\n2. **Sensitivity to $a$ (Speed):** A higher $a$ (0.8 vs 0.2) causes the curve to reach the long-term mean much faster, resulting in a steeper initial slope.\n\n3. **Sensitivity to $b$ (Mean):** Increasing $b$ shifts the entire \"long end\" of the curve upward, as the market expects rates to be higher in the distant future.\n\n4. **Sensitivity to $\\sigma$ (Volatility):** Higher volatility actually creates a downward pressure on the yield curve for long maturities. This is due to \"convexity bias\"—as uncertainty increases, the value of the bond's floor (it can't go below zero) becomes more valuable, raising the bond price and thus lowering the yield.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"show","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"html-math-method":"mathjax","output-file":"cir_model.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.8.25","theme":["cosmo","brand"],"title":"**The CIR Stochastic Differential Equation (SDE)**"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}